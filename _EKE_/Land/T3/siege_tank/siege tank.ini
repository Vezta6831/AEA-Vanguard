#by Lilium Stargazzer
#Game version: RW v1.15p6
#Siege Tank from starKraft series
[core]
#----------------------------------------------------
#Open secondary cannon (sont touch this)
@global intr: 0.02
#---------------------
#damage multiplier and reload reduction multiplier
@global powerMul: 2
#Tank base damage
@global basDmg: 120
#-------------------- siege mode
#Bonus range in siege mode
@global range: 170
#Bonus damage in siege mode
@global bonusDmg: 50
#Bonus splash damage percentage in siege mode
@global bonusSplhPer: 0.5
#Bonus fogOfWarSightRange
@global FOFSR: 10
#----------------------------------------------------
	name: siege_tank
	copyFrom:ROOT:statusEffect.template
	displayText: Siege Tank
	displayDescription: - Decent armour\n- High AOE projectile\n- Strong vs Structures\n- Deploys to siege mode for extra range/dmg
	displayText_ru: Осадный Танк
	displayDescription_ru: - Неплохая броня\n- Большая область поражения\n- Повышенный урон по зданиям\n- Может перейти в осадный режим для увеличения радиуса атаки и урона\n- Атакует только наземную технику.
	displayText_zh: 攻城坦克
	displayDescription_zh: -中规中矩的装甲\n-高范围爆炸炮弹\n-部署到攻城模式以获得额外射程/伤害
	class: CustomUnitMetadata
	price: 8000
	maxHp: 2000
	mass: 50000
	armour: 12
	experimental: false
	techLevel: 2
	buildSpeed: 38.8s
	#availableInDemo: true
	numBitsOnDeath: 15
	transportSlotsNeeded: 5
	radius: 30
	displayRadius: 30
	isBio: false
	softCollisionOnAll: 0
	autoTriggerCooldownTime: 0.1s
	autoTriggerCooldownTime_allowDangerousHighCPU: true
	fogOfWarSightRange: 15
	energyMax: 1
	energyRegen: 0.002
	energyNeedsToRechargeToFull: true
#===============================================
		[template_flag1A]
		#dummy turret tank mode
		invisible: if self.hasFlag(id=20)
		[template_flag1B]
		#dummy turret siege mode 
		invisible: if not self.hasFlag(id=21)
		[template_flag1C]
		hidden: if not self.hasFlag(id=22)
		[template_flag1D]
		hidden: if self.hasFlag(id=22)
    [template_statC]
		  convertTo_keepCurrentFields: mass, maxAttackRange, shootDelayMultiplier, moveSpeed, maxTurnSpeed, fogOfWarSightRange
		[action_siegemode]
		  ai_isDisabled: false
			ai_isHighPriority: if not self.hasFlag(id=21) and self.hasActiveWaypoint(type='ATTACKMOVE') and distanceBetween(self, activeWaypointTarget) < 250 and numberOfUnitsInEnemyTeam(withinRange=${attack.maxAttackRange+range}) < 1
			isActive: if not self.hasFlag(id=28)
			isVisible: if not self.hasFlag(id=28)
			text: Siege Mode
			description:  - Transforms the Siege Tank into siege mode \n - Gains splash ${bonusSplhPer*100}% damage, greatly increased range (+${range}) and ${powerMul*100}% damage \nat the cost of losing all mobility and ${powerMul}x slower firing rate.
			text_ru: Осадный Режим
			description_ru: - Трансформирует танк в осадный режим\n- Наносит на ${bonusSplhPer*100}% больше урона благодаря атаке по области, увеличивает радиус атаки на ${range} и урон на ${powerMul*100}%\nЗа это расплачивается отсутствием мобильности и пониженной в ${powerMul} раза скорострельностью 
			text_zh: 攻城模式
			description_zh:  -将攻城坦克变形为攻城模式\n-提升${bonusSplhPer*100}%的伤害，大幅增加射程（+${range}）和${powerMul*100}%的伤害，\n-代价是失去所有机动性以及减少${powerMul}x的攻击延迟
			buildSpeed: 0.1s
			clearAllWaypoints: true
			addResources: setFlag=0, setFlag=30, setFlag=28, setFlag=26
			setUnitStats: maxTurnSpeed-=${movement.maxTurnSpeed}
			alsoQueueAction: open_1
			playAnimation: tank_tracks_deploy
			whenBuilding_cannotMove: true
			alwaysSinglePress: true
			allowMultipleInQueue: false
			canPlayerCancel: false
		[action_tankmode]
		@copyFromSection: action_siegemode
		  ai_isDisabled: false
			ai_isHighPriority: if numberOfUnitsInEnemyTeam(withinRange=${attack.maxAttackRange+range}) > 0 and not self.isAttacking() and self.hasActiveWaypoint(type='ATTACKMOVE') and self.hasFlag(id=21) and self.isEnergyFull()
			isActive: if self.hasFlag(id=27) and self.hasFlag(id=28)
			isVisible: if self.hasFlag(id=27) and self.hasFlag(id=28)
			text: Tank Mode
			description: Transforms the Siege Tank back into tank mode\n where it gains the ability to move and fire at faster rate
			text_ru: Режим Танка
			description_ru: - Трансформирует осадный танк в изначальное состояние,\nвновь позволяя ему двигаться и быстрее стрелять
			text_zh: 坦克模式
			description_zh: 将攻城坦克变回坦克模式\n在此模式下，它可以更快地移动和开火
		  addResources: setFlag=0, unsetFlag=27, setFlag=26, unsetFlag=25
			setUnitStats: IGNORE
			alsoQueueAction: close_1
			playAnimation: tank_tracks_undeploy	
			stopLastAnimation: true
    [action_transforming]
      displayType: infoOnlyNoBox
     	isVisible: if self.hasFlag(id=26)
			isActive: false
     	text: Transforming
		text_ru: Трансформация...
     			text_zh: 正在变形...
			buildSpeed: 0
		#--------------------------
		[hiddenAction_open_1]
			buildSpeed: 1s
			addResources: setFlag=1, setFlag=20
			alsoQueueAction: open_2
			whenBuilding_cannotMove: true
		[hiddenAction_open_2]
			@define num: 2
			buildSpeed: ${intr}s
			addResources: setFlag=${num}, unsetFlag=${num-1}
			alsoQueueAction: open_${num+1}
			whenBuilding_cannotMove: true
		[hiddenAction_open_3]
		@copyFromSection: hiddenAction_open_2
		@define num: 3
		[hiddenAction_open_4]
		@copyFromSection: hiddenAction_open_2
		@define num: 4
		buildSpeed: ${intr+1.5}s
		[hiddenAction_open_5]
		@copyFromSection: hiddenAction_open_2
		@define num: 5
		[hiddenAction_open_6]
		@copyFromSection: hiddenAction_open_2
		@define num: 6
		[hiddenAction_open_7]
		@copyFromSection: hiddenAction_open_2
		@define num: 7
		[hiddenAction_open_8]
		@copyFromSection: hiddenAction_open_2
		@define num: 8
		[hiddenAction_open_9]
		@copyFromSection: hiddenAction_open_2
		@define num: 9
		[hiddenAction_open_10]
		@copyFromSection: hiddenAction_open_2
		@define num: 10
		[hiddenAction_open_11]
		@copyFromSection: hiddenAction_open_2
		@define num: 11
		[hiddenAction_open_12]
			@copyFromSection: hiddenAction_open_2
			@define num: 12
			alsoQueueAction: open_end
			whenBuilding_cannotMove: true
		[hiddenAction_open_end]
			buildSpeed: ${intr}s
			addResources: setFlag=21, unsetFlag=12
			setUnitStats: mass+=500000, maxAttackRange+=170, shootDelayMultiplier+=${(attack.shootDelay*(powerMul/100))}, moveSpeed-=${movement.moveSpeed}, fogOfWarSightRange+=15
			alsoQueueAction: armed_siegeMode
			clearAllWaypoints: true
			whenBuilding_cannotMove: true
		[hiddenAction_armed_siegeMode]
		@copyFromSection: template_statC
			buildSpeed: 0.5s
			addResources: unsetFlag=0, setFlag=22, setFlag=27, unsetFlag=26, energy=-1
			whenBuilding_cannotMove: true
			stopLastAnimation: true
			resetCustomTimer: true
			convertTo: siege_tank_sm
		#END	
		[hiddenAction_close_1]
			buildSpeed: 1.5s
			addResources: setFlag=12, unsetFlag=21, unsetFlag=22
			alsoQueueAction: close_2
			whenBuilding_cannotMove: true
		[hiddenAction_close_2]
			@define num: 2
			buildSpeed: ${intr}s
			addResources: setFlag=${13-num}, unsetFlag=${14-num}
			alsoQueueAction: close_${num+1}
			whenBuilding_cannotMove: true
    [hiddenAction_close_3]
		@copyFromSection: hiddenAction_close_2
			@define num: 3
			buildSpeed: ${intr}s
		[hiddenAction_close_4]
		@copyFromSection: hiddenAction_close_2
			@define num: 4
		[hiddenAction_close_5]
		@copyFromSection: hiddenAction_close_2
			@define num: 5
		[hiddenAction_close_6]
		@copyFromSection: hiddenAction_close_2
			@define num: 6
		[hiddenAction_close_7]
		@copyFromSection: hiddenAction_close_2
			@define num: 7
		[hiddenAction_close_8]
		@copyFromSection: hiddenAction_close_2
			@define num: 8
			buildSpeed: ${intr+1.5}s
		[hiddenAction_close_9]
		@copyFromSection: hiddenAction_close_2
			@define num: 9
		[hiddenAction_close_10]
		@copyFromSection: hiddenAction_close_2
			@define num: 10
		[hiddenAction_close_11]
		@copyFromSection: hiddenAction_close_2
			@define num: 11
		[hiddenAction_close_12]
		@copyFromSection: hiddenAction_close_2
			@define num: 12
			alsoQueueAction: close_end	
    [hiddenAction_close_end]
			buildSpeed: ${intr}s	
			addResources: unsetFlag=1, unsetFlag=20
			setUnitStats: mass-=500000, maxAttackRange-=170, shootDelayMultiplier-=${(attack.shootDelay*(powerMul/100))}, moveSpeed+=${movement.moveSpeed}, maxTurnSpeed+=${movement.maxTurnSpeed}, fogOfWarSightRange-=15
			alsoQueueAction: armedtankMode
			whenBuilding_cannotMove: true
    [hiddenAction_armedtankMode]
		@copyFromSection: template_statC
			buildSpeed: 0.5s
			addResources: unsetFlag=0, unsetFlag=30, unsetFlag=28, unsetFlag=26
			whenBuilding_cannotMove: true		
			stopLastAnimation: true
			convertTo: siege_tank
		#--------------------------------------------------------------------------
		[hiddenAction_siegeModeMS]
			autoTriggerOnEvent: newWaypointGivenByPlayer
			requireConditional: if not self.isControlledByAI() and not self.hasActiveWaypoint(type='ATTACK') and not self.hasFlag(id=0) and self.hasFlag(id=21)
			clearAllWaypoints: true
		[hiddenAction_siegeModeBugFix]
		  autoTriggerOnEvent: newWaypointGivenByPlayer
			requireConditional: if not self.isControlledByAI() and not self.hasFlag(id=0) and self.hasFlag(id=21)
		  autoTrigger: if not self.isControlledByAI() and distanceBetween(self, activeWaypointTarget) > 420 and self.hasActiveWaypoint(type='ATTACK')
			clearAllWaypoints: true
		#--------------------------------------------------------------------------AI
			[hiddenAction_AI_deployment_A]
			@define num: 0
			@define type: ATTACK
				autoTriggerOnEvent: newWaypointGivenByPlayer
				requireConditional: if self.queueSize() < 1 and not self.hasFlag(id=26) and self.isControlledByAI() and (numberOfUnitsInEnemyTeam(withinRange=${attack.maxAttackRange+range}) > ${num} and distanceBetween(self, activeWaypointTarget) < 420 and self.isAttacking()) and self.hasActiveWaypoint(type='${type}') and not self.hasFlag(id=0) and not self.hasFlag(id=20) and self.isEnergyFull()
				alsoQueueAction: siegemode
				debugMessage: AI deploying A
			[hiddenAction_AI_deployment_B]
			@copyFromSection: hiddenAction_AI_deployment_A
			@define num: 2
			@define type: ATTACK
				debugMessage: AI deploying B
			[hiddenAction_AI_deployment_C]
				autoTrigger: if self.isControlledByAI() and numberOfUnitsInEnemyTeam(withinRange=${attack.maxAttackRange+range}) > 5 and self.hasActiveWaypoint(type='ATTACKMOVE') and not self.hasFlag(id=0) and not self.hasFlag(id=20)
				requireConditional: if self.queueSize() < 1 and not self.hasFlag(id=26) and self.isEnergyFull() 
				alsoQueueAction: siegemode
				debugMessage: AI deploying C
			#-----------------------------------
			[hiddenAction_AI_noEnemy]
				autoTrigger: if self.isControlledByAI() and numberOfUnitsInEnemyTeam(withinRange=${attack.maxAttackRange+range}) < 1 and not self.isAttacking() and not self.hasFlag(id=0) and self.hasFlag(id=21) and not self.hasFlag(id=25) and self.customTimer(laterThanSeconds=6)
				requireConditional: if self.queueSize() < 1 and not self.hasFlag(id=26) and self.isEnergyFull() 
				debugMessage: AI not attacking
				addResources: setFlag=25
			[hiddenAction_AI_attacking]	
			@define type: ATTACK
				autoTriggerOnEvent: newWaypointGivenByPlayer
				requireConditional: if self.isControlledByAI() and numberOfUnitsInEnemyTeam(withinRange=${attack.maxAttackRange+range}) < 1 and self.hasActiveWaypoint(type='${type}') and distanceBetween(self, activeWaypointTarget) > 420 and self.hasFlag(id=21) and not self.hasFlag(id=25) and not self.hasFlag(id=26) and self.customTimer(laterThanSeconds=6) and self.isEnergyFull()
				alsoQueueAction: tankmode
				debugMessage: AI attacking out of range
			[hiddenAction_AI_attacking|Move]	
			@copyFromSection: hiddenAction_AI_attacking	
			@define type: ATTACKMOVE
				debugMessage: AI attackmove out of range
			[hiddenAction_AI_Move]	
			@copyFromSection: hiddenAction_AI_attacking	
			@define type: MOVE
				debugMessage: AI move out of range
			[hiddenAction_AI_siegeModeNoEnemy]	
				autoTrigger: if self.isControlledByAI() and self.hasFlag(id=21) and self.isEnergyFull() and (numberOfUnitsInEnemyTeam(withinRange=${attack.maxAttackRange+range}) < 1 or numberOfUnitsInEnemyTeam(withinRange=${attack.maxAttackRange+range}) > 0 and not self.isAttacking() and self.hasActiveWaypoint(type='ATTACKMOVE'))
				requireConditional: if self.queueSize() < 1 and not self.hasFlag(id=26)	
				resetCustomTimer: true
				alsoQueueAction: tankmode
				
			[hiddenAction_AI_siegeModeNewWaypoint]
				autoTriggerOnEvent: newWaypointGivenByPlayer		
				requireConditional: if self.isControlledByAI() and self.hasFlag(id=21) 
				resetCustomTimer: true 
				addResources: energy=-1
		#--------------------------------------------------------------------------		
		[hiddenAction_created]
			autoTriggerOnEvent: created
			addResources: setFlag=31
		[hiddenAction_resetTimer]
		  resetCustomTimer: true
			addResources: energy=-1
		#--------------------------------------------------------------------------
		  [animation_movingAiSeploy_end]
				body_1s:    {frame: 0}
			[animation_tank_tracks_deploy]
				blendIn: 0.5s
				blendOut: 0.5s
				KeyframeTimeScale: 0.5
			#--------------------------
				effect_0s:{x:0,y:0,name:CUSTOM|T}
				leg1_0s:    {x:0,  y:0, dir:0}
				leg1_1s:    {x:0,  y:3, dir:0}
				leg1_3s: 		{x:0,  y:3, dir:0}
				leg1_3.5s:  {x:-2, y:3, dir:0}
				leg1_4s:    {x:-2, y:3, dir:0}
				leg1_5s:    {x:-3, y:7, dir:-35}
				leg1_9s:   	{x:-3, y:7, dir:-35}
			#--------------------------
				leg2_0s:    {x:0,  y:0, dir:0}
				leg2_1s:    {x:0,  y:3, dir:0}
				leg2_3s:    {x:0,  y:3, dir:0}
				leg2_3.5s:  {x:2,  y:3, dir:0}
				leg2_4s:    {x:2,  y:3, dir:0}
				leg2_5s:    {x:3,  y:7, dir:35}
			#--------------------------
				leg3_0s:    {x:0,  y:0, dir:0}
				leg3_1s:    {x:0,  y:-3, dir:0}
				leg3_3s:    {x:0,  y:-3, dir:0}
				leg3_3.5s:  {x:-2, y:-3, dir:0}
				leg3_4s:    {x:-2, y:-3, dir:0}
				leg3_5s:    {x:-3, y:-7, dir:35}
			#--------------------------
				leg4_0s:    {x:0,  y:0, dir:0}
				leg4_1s:    {x:0,  y:-3, dir:0}
				leg4_3s:    {x:0,  y:-3, dir:0}
				leg4_3.5s:  {x:2,  y:-3, dir:0}
				leg4_4s:    {x:2,  y:-3, dir:0}
				leg4_5s:    {x:3,  y:-7, dir:-35}
			#--------------------------	
			  leg9_0s:    {x:0,  y:0, dir:0}
				leg9_1s:    {x:-20,  y:0, dir:0}
				leg9_3s:    {x:-20,  y:0, dir:0}
				leg9_3.5s:  {x:-20,  y:0, dir:90}
			#--------------------------	
			  leg10_0s:   {x:0,  y:0, dir:0}	
				leg10_1s:   {x:20,  y:0, dir:0}
				leg10_3s:   {x:20,  y:0, dir:0}
				leg10_3.2s: {x:20,  y:0, dir:-90}
		  [animation_tank_tracks_undeploy]	
			#@copyFromSection: animation_tank_tracks_deploy
				blendIn: 0.5s
				blendOut: 0.5s
				KeyframeTimeScale: 0.5
			#--------------------------	
				leg1_0.1s:  {x:-3, y:7, dir:-35}
				leg1_3s:    {x:-3, y:7, dir:-35}
				leg1_4s:    {x:-2, y:3, dir:0}
				leg1_5s:    {x:-2, y:3, dir:0}
				leg1_5.5s: 	{x:0,  y:3, dir:0}
			#--------------------------	
				effect_0s:{x:0,y:0,name:CUSTOM|T-1}
				leg2_0.1s:  {x:3, y:7, dir:35}
				leg2_3s:    {x:3, y:7, dir:35}
				leg2_4s:    {x:2, y:3, dir:0}
				leg2_5s:    {x:2, y:3, dir:0}
				leg2_5.5s:  {x:0,  y:3, dir:0}	
			#--------------------------	
				leg3_0.1s:  {x:-3, y:-7, dir:35}
				leg3_3s:    {x:-3, y:-7, dir:35}
				leg3_4s:    {x:-2, y:-3, dir:0}
				leg3_5s:    {x:-2, y:-3, dir:0}
				leg3_5.5s: 	{x:0,  y:-3, dir:0}	
			#--------------------------	
				leg4_0.1s:  {x:3, y:-7, dir:-35}
				leg4_3s:    {x:3, y:-7, dir:-35}
				leg4_4s:    {x:2, y:-3, dir:0}
				leg4_5s:    {x:2, y:-3, dir:0}
				leg4_5.5s:  {x:0, y:-3, dir:0}
			#--------------------------
     		leg9_0.5s:  {x:-20,  y:0, dir:90}	
				leg9_3s:    {x:-20,  y:0, dir:90}	
				leg9_4s:  {x:-20,  y:0, dir:0}	
				leg9_5s:    {x:0,  y:0, dir:0}	
			#--------------------------
     		leg10_0.5s:  {x:20,  y:0, dir:-90}	
				leg10_3s:    {x:20,  y:0, dir:-90}	
				leg10_4s:  {x:20,  y:0, dir:0}	
				leg10_5s:    {x:0,  y:0, dir:0}
				[effect_T]
				priority:critical
				image:SHARED:blank.png
				life:0
				fadeOut: true
				fadeInTime:0
				attachedToUnit:false
				color:#000000
				scaleTo: 0
				scaleFrom: 0
				alpha:0.1
				alsoEmitEffectsOnDeath:CUSTOM:T1

				[effect_T1]
				priority:critical
				image:SHARED:blank.png
				life:120
				fadeOut: true
				fadeInTime:0
				attachedToUnit:false
				color:#000000
				scaleTo: 0
				scaleFrom: 0
				alpha:0.1
				alsoPlaySound:T1.ogg:1.5
				alsoEmitEffectsOnDeath:CUSTOM:T2

				[effect_T2]
				priority:critical
				image:SHARED:blank.png
				life:0
				fadeOut: true
				fadeInTime:0
				attachedToUnit:false
				color:#000000
				scaleTo: 0
				scaleFrom: 0
				alpha:0.1
				alsoPlaySound:T2.ogg:1.5
	
				[effect_T-1]
				priority:critical
				image:SHARED:blank.png
				life:0
				fadeOut: true
				fadeInTime:0
				attachedToUnit:false
				color:#000000
				scaleTo: 0
				scaleFrom: 0
				alpha:0.1
				alsoEmitEffectsOnDeath:CUSTOM:T-1-1

				[effect_T-1-1]
				priority:critical
				image:SHARED:blank.png
				life:120
				fadeOut: true
				fadeInTime:0
				attachedToUnit:false
				color:#000000
				scaleTo: 0
				scaleFrom: 0
				alpha:0.1
				alsoPlaySound:T2.ogg:1.5
				alsoEmitEffectsOnDeath:CUSTOM:T-1-2

				[effect_T-1-2]
				priority:critical
				image:SHARED:blank.png
				life:0
				fadeOut: true
				fadeInTime:0
				attachedToUnit:false
				color:#000000
				scaleTo: 0
				scaleFrom: 0
				alpha:0.1
				alsoPlaySound:T1.ogg:1.5			
[graphics]
	total_frames: 4
	image:        siege_tank_body.png
	image_wreak:  oof.png
	image_turret: siege_tank_barbette.png
	image_shadow: NONE
	shadowOffsetX:3
	shadowOffsetY:3
	animation_moving_start: 1
	animation_moving_end: 3
	animation_moving_speed: 3.5
	teamColorsOnTurret: true
	movementEffect:        CUSTOM:dustL, CUSTOM:dustR
	movementEffectReverse: CUSTOM:dustL, CUSTOM:dustR
	movementEffectReverseFlipEffects: true
	movementEffectRate: 8
	showQueueBar: false
	showEnergyBar: false
#===============================================================	
[attack]
	canAttack: true
	canAttackFlyingUnits: false
	canAttackLandUnits:   true
	canAttackUnderwaterUnits: false
	turretSize: 17
	turretTurnSpeed: 4
	maxAttackRange: 250
	shootDelay: 80
	turretMultiTargeting: true
		[turret_idle]		
		@copyFromSection: turret_top
		  attachedTo: IGNORE
			slave: 			IGNORE
			image: siege_tank_body_idle.png	
			invisible: if self.isMoving() and self.hasFlag(id=31) and not self.hasFlag(id=30) and (self.hasActiveWaypoint(type='MOVE') or self.hasActiveWaypoint(type='ATTACKMOVE')) or self.hasFlag(id=31) and self.hasFlag(id=30) or self.hasFlag(id=30)
	[turret_cannon]
	#Primary gun
	@copyFromSection: template_flag1A
		x: 0
		y: 0
		attachedTo: Barbette
		slave: true
		projectile: 1
		turnSpeed: 0
		canAttackFlyingUnits: false
		canAttackLandUnits:   if not self.hasFlag(id=0) and not self.hasFlag(id=21)
		canAttackUnderwaterUnits: false
		shoot_sound:large_gun_fire1
		shoot_sound_vol:0.3
		shoot_flame:large
		shoot_light:#FFff925c
		image: siege_tank_cannon.png
		canShoot: true
		warmup:0
		size: 20
		recoilOffset: -5
		recoilOutTime: 3
		recoilReturnTime: 50
	[turret_cannon_siegeMode]	
	@copyFromSection: turret_cannon, template_flag1B
	  image: siege_tank_cannon_siegeMode.png
		canAttackLandUnits:   if not self.hasFlag(id=0) and self.hasFlag(id=21)
		projectile: 2_siegeMode
		shoot_sound:cannon_firing
		shoot_sound_vol:0.6
		onShoot_triggerActions: resetTimer
		[turret_sidePlate]	
		#dummy turret
		@copyFromSection: turret_cannon, template_flag1A
			projectile: Dummy
			linkDelayWithTurret: cannon
			warmup: 0
			shoot_sound:     IGNORE
			shoot_sound_vol: IGNORE
			shoot_flame:     IGNORE
			shoot_light:     IGNORE
			image: siege_tank_sidePlateG.png	
			recoilOffset: -4
			recoilOutTime: 3
			recoilReturnTime: 27	
#-------------------------------			
		[turret_railA_siegeMode]	
		@copyFromSection: turret_sidePlate_siegeMode
			image: siege_tank_cannon_siegeMode_rail_A.png
			recoilOffset: -13
			recoilOutTime: 11
			recoilReturnTime: 120	
		[turret_railB_siegeMode]	
		@copyFromSection: turret_sidePlate_siegeMode
			image: siege_tank_cannon_siegeMode_rail_B.png	
			recoilOffset: -8
			recoilOutTime: 9
			recoilReturnTime: 120
    [turret_sidePlate_siegeMode]	
		@copyFromSection: template_flag1B
			x: 0
			y: 0
		  attachedTo: Barbette
			slave: true
			projectile: Dummy
			canShoot: true
			delay: ${(attack.shootDelay*powerMul)}
			linkDelayWithTurret: cannon_siegeMode
			warmup: 0
			image: siege_tank_sidePlateG_siegeMode.png	
			canAttackLandUnits:   if not self.hasFlag(id=0) and self.hasFlag(id=21)
			shoot_flame:large
			shoot_light:#FFff925c
			recoilOffset: -6
			recoilOutTime: 15
			recoilReturnTime: 80
#-------------------------------			
	[turret_Barbette]
	#turret base
			x: 0
			y: 0
			canShoot: false
			turnSpeed: 2
			turnSpeedAcceleration: 0.3
			canAttackFlyingUnits: false
			canAttackLandUnits:   true
			canAttackUnderwaterUnits: false
			recoilOffset: -0.2
			recoilOutTime: 3
			recoilReturnTime: 27
			#========================
			idleSweepCondition: if not self.isMoving()
			idleSweepAddRandomAngle:10
			idleSweepAngle:15
			idleSweepDelay:380
			idleSweepSpeed:0.5
#======================================Animation		
			[turret_anim_0]
			@define num: 1
				x: 0
				y: 0
				attachedTo: Barbette
				slave: true
				image: stC_${num}.png
				invisible: if not self.hasFlag(id=${num})
				canShoot: false			
			[turret_anim_1]	
			@copyFromSection: turret_anim_0
			@define num: 1
			[turret_anim_2]	
			@copyFromSection: turret_anim_0
			@define num: 2
			[turret_anim_3]	
			@copyFromSection: turret_anim_0
			@define num: 3
			[turret_anim_4]	
			@copyFromSection: turret_anim_0
			@define num: 4
			[turret_anim_5]	
			@copyFromSection: turret_anim_0
			@define num: 5
			[turret_anim_6]	
			@copyFromSection: turret_anim_0
			@define num: 6
			[turret_anim_7]	
			@copyFromSection: turret_anim_0
			@define num: 7
			[turret_anim_8]	
			@copyFromSection: turret_anim_0
			@define num: 8
			[turret_anim_9]	
			@copyFromSection: turret_anim_0
			@define num: 9
			[turret_anim_10]	
			@copyFromSection: turret_anim_0
			@define num: 10
			[turret_anim_11]	
			@copyFromSection: turret_anim_0
			@define num: 11
			[turret_anim_12]	
			@copyFromSection: turret_anim_0
			@define num: 12
#======================================Animation end		
		[turret_top]	
		#dummy turret
		@copyFromSection: turret_cannon, template_flag1A
			image: siege_tank_sidePlateA.png
			#invisible: true
			canShoot: false
		[turret_top_siegeMode]		
		@copyFromSection: turret_top, template_flag1B
			image: siege_tank_sidePlateA_siegeMode.png
		[turret_FacePlate]
		#dummy turret	
		@copyFromSection: turret_cannon
				projectile: Dummy
				linkDelayWithTurret: cannon
				invisible: false
				warmup: 0
				image: siege_tank_facePlate.png
				recoilOffset: -1.5
				recoilOutTime: 3
				recoilReturnTime: 15
				limitingRange: 420	
#===============================================================
	[projectile_Dummy]
	#dummy projectile
		directDamage: 0
		life: 0
		speed: 0
		drawSize: 0
		color: #46ebff
		lightColor: #46ebff
		lightSize: 0
	[projectile_1]
		areaDamage: ${basDmg}
		areaRadius: 35
		life: 190
		frame: 9
		speed: 10
		drawSize: 0.85
		largeHitEffect: true
		lightColor: #ffff925c
		lightSize: 0.6
		#trailEffect: CUSTOM:projectileTrail
		#trailEffectRate:2
		buildingDamageMultiplier: 2.50
		targetGround: true
		targetGroundSpread: 10
		initialUnguidedSpeedHeight: 0.5
		gravity:0.18
		lightCastOnGround: true
		deflectionPower: 4
		[projectile_2_siegeMode]
		@copyFromSection: projectile_1
			areaDamage: ${(basDmg*powerMul)+bonusDmg}
			areaRadius: 50
			drawSize: 1.2
			trailEffect: CUSTOM:projectileTrail
			trailEffectRate:0.5
			spawnProjectilesOnExplode: 2_siegeMode_extraBlast
			lightColor: #ffff925c
			lightSize: 1
			tags: ifc2
			deflectionPower: 4
		[projectile_2_siegeMode_extraBlast]
		@copyFromSection: projectile_2_siegeMode
			areaDamage: ${((basDmg*powerMul)+bonusDmg)*bonusSplhPer}
			life: 0
			areaRadius: 110
			drawSize: 0
			areaRadiusFromEdge: true
			areaIgnoreUnitsCloserThan: 50
			spawnProjectilesOnExplode: IGNORE
			explodeOnEndOfLife: true
			deflectionPower: 4
	[leg_1]
	#tracks front
	@copyFromSection: template_flag1D
		x: -8
		y: 13
		attach_x: -6
		attach_y: 3
		moveSpeed: 2.3
		rotateSpeed: 3
		image_end_teamColors: true
		image_leg:  barrel.png
		image_foot: siege_tank_Ttrack_front_1.png
		draw_foot_on_top: true
		drawOverBody: false
		lockMovement: true
		drawUnderAllUnits: true
		endDirOffset: 0	
	[leg_2]	
	#tracks front
		@copyFromSection: leg_1
		x: 8
		attach_x: 6
		image_foot: siege_tank_Ttrack_front_2.png
	[leg_3]	
	#tracks rear
	  @copyFromSection: leg_1
		x: -8
		y: -13
		attach_x: -6
		attach_y: -3
		image_foot: siege_tank_Ttrack_rear_2.png
		endDirOffset: 180	
	[leg_4]	
	#tracks rear
		@copyFromSection: leg_3
		x: 8
		attach_x: 6
		image_foot: siege_tank_Ttrack_rear_1.png
		endDirOffset: 180	
	#------------dummy fixed
  [leg_5]
	@copyFromSection: leg_1, template_flag1C
		x: -11
		y: 20
		endDirOffset: -35
	[leg_6]
	@copyFromSection: leg_2, template_flag1C
		x: 11
		y: 20
		attach_x: 6
		endDirOffset: 35
	[leg_7]
	@copyFromSection: leg_3, template_flag1C
		x: -11
		y: -20
		attach_x: -6
		attach_y: -3
		endDirOffset: 215
	[leg_8]
	@copyFromSection: leg_4, template_flag1C
		x: 11
		y: -20
		attach_x: 6
		endDirOffset: 145
	#---------------pad	
	[leg_9]	
	@copyFromSection: leg_1, template_flag1D
	  x: -6
		y: 0
		attach_x: -6
		attach_y: 0
		hidden: false
		image_leg:  siege_tank_arm.png
		image_foot: siege_tank_pad.png
		draw_foot_on_top: false
		endDirOffset: 90	
	[leg_10]	
  @copyFromSection: leg_9
		x: 6
		y: 0
		attach_x: 6
	[leg_11]	
	@copyFromSection: leg_9, template_flag1C
		x: -26
		endDirOffset: 180
  [leg_12]		
	@copyFromSection: leg_10, template_flag1C
		x: 26
		endDirOffset: 0
[effect_projectileTrail]
	stripIndex: effects
	frameIndex: 0
	#image: SHARED:light_50.png
	life: 20
	fadeOut: true
	attachedToUnit: false
	color: #ffff925c
	fadeInTime:5
	scaleFrom: 0.6
	scaleTo: 0.9
	alpha: 0.6
	drawUnderUnits:false
	#ySpeedRelative:-1
	atmospheric:true
	dirOffsetRandom:180
	xSpeedAbsoluteRandom: 0.2
	ySpeedAbsoluteRandom: 0.2
	ySpeedRelative:0.8
[effect_dustL]
	life: 30
	stripIndex: dust
	frameIndex: 0
	frameIndexRandom: 2
	scaleFrom: 1.5
	scaleTo: 1.9
	alpha: 0.6
	atmospheric:true
	#dirOffsetRandom:180
	xSpeedAbsoluteRandom: 0.1
	ySpeedAbsoluteRandom: 0.1
	ySpeedRelative:-0.8
	hSpeed:0.1
	xOffsetRelative:17
	yOffsetRelative:-34
	drawUnderUnits:true
	attachedToUnit: false
[effect_dustR]
	life: 30
	stripIndex: dust
	frameIndex: 0
	frameIndexRandom: 2
	scaleFrom: 1.5
	scaleTo: 1.9
	alpha: 0.6
	atmospheric:true
	#dirOffsetRandom:180
	xSpeedAbsoluteRandom: 0.1
	ySpeedAbsoluteRandom: 0.1
	ySpeedRelative:-0.8
	hSpeed:0.1
	xOffsetRelative:-17
	yOffsetRelative:-34
	drawUnderUnits:true
	attachedToUnit: false
[movement]
	movementType: LAND
	moveSpeed: 0.75
	moveAccelerationSpeed: 0.03
	moveDecelerationSpeed: 0.1
	reverseSpeedPercentage: 1.0
	maxTurnSpeed: 0.9
	turnAcceleration: 0.1
	moveSlidingMode :false
	moveIgnoringBody:false