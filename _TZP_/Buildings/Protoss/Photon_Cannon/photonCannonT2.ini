[core]
copyFrom:ROOT:/DATA/total/baseAttack.template, ROOT:/DATA/Protoss/buildings.template, ROOT:/DATA/total/customUI.template
name: PhotonCannonT2
tags:detector,building,landAttackTarget,haveShield, photonCannon
class: CustomUnitMetadata
price: 0
maxHp: 850
maxShield:600
shieldRegen:0.08
startShieldAtZero:false
shieldDisplayOnlyDeflection:true
mass: 9000
armour:1
hideScorchMark: false
fogOfWarSightRange:17
displayText_ru:Фотонная пушка
displayText:Photon cannon T2
displayDescription_ru: ДЕТЕКТОР
displayDescription: -Detects hidden units/n-capable cannon with ground and air attack
footprint: -1,-1,1,1
constructionFootprint:-1,-1,1,1
buildingToFootprintOffsetX:10
buildingToFootprintOffsetY:5
techLevel: 1
buildSpeed: 1
selfBuildRate: 1
radius: 40
isBuilder: false
nanoRange: 0
isBuilding: true
isBio: true
numBitsOnDeath: 12
isUnrepairableUnit:false
effectOnDeath: CUSTOM:corpse

[hiddenAction_completeTeleportation]
autoTrigger: if self.lastConverted>=1.9 and not self.tags(includes="complete")
temporarilyAddTags: complete

[hiddenAction_notWorking]
autoTrigger: if not self.hasUnitInTeam(withTag='pylon',withinRange=300) and self.tags(includes='detector')
temporarilyRemoveTags:detector

[hiddenAction_Working]
autoTrigger: if self.hasUnitInTeam(withTag='pylon',withinRange=300) and not self.tags(includes='detector')
temporarilyAddTags:detector

[decal_fire]
@copyFromSection: template_fire
isVisible: if self.hp<self.maxHp*0.85
image:ROOT:/DATA/Protoss/fire.png
frame: select(self.hp<self.maxHp*0.7,12,0)+(self.timeAlive*12%12)
xOffsetAbsolute:-8
yOffsetAbsolute:-15

[decal_fire_2]
@copyFromSection: template_fire
isVisible: if self.hp<self.maxHp*0.55
image:ROOT:/DATA/Protoss/fire3.png
frame: select(self.hp<self.maxHp*0.4,12,0)+(self.timeAlive*12%12)
xOffsetAbsolute:10
yOffsetAbsolute:8

[effect_corpse]
alwayStartDirAtZero:true
attachedToUnit: false
life: 100
alpha: 10
image: ROOT:/DATA/Protoss/death.png
alsoPlaySound:ROOT:/DATA/total/buildingExplode.wav
priority: critical
drawUnderUnits:false
total_frames:10
animateFrameStart:0
animateFrameEnd:9
animateFrameSpeed:0.2
frame_width:  190
frame_height: 152

[action_Convert_T3]
convertTo: PhotonCannonT3
price:Gas=1080
buildSpeed: 46s
text: T3
description: Converts into T3 Cannon
descriptionAddUnitStats: ${section.convertTo}
pos: 1


[hiddenAction_attacking]
autoTrigger: if not self.isAttacking and self.lastConverted>=1 and self.queueSize<=0
stopLastAnimation:true
alsoQueueAction:attacking_2

[hiddenAction_attacking_2]
convertTo: PhotonCannonNA2
convertTo_keepCurrentTags: true
buildSpeed: 0.32s
highPriorityQueue: true
whenBuilding_playAnimation: notAttack
canPlayerCancel:false

[effect_sparks]
alwayStartDirAtZero:true
attachedToUnit: false
life: 140
alpha: 14
hSpeed: 0
image: ROOT:/DATA/Protoss/units/spark.png
priority: critical
drawUnderUnits:false
total_frames:14
animateFrameStart:0
animateFrameEnd:13
animateFrameSpeed:0.25
scaleFrom:1
scaleTo: 1

[graphics]
image_offsetY:8
default_frame: 3
total_frames: 4
image: photonCannon.png
image_wreak:  ROOT:/DATA/Protoss/dead.png
drawLayer:experimentals
image_shadow:shadow.png
shadowOffsetX:0
shadowOffsetY:8

[attack]
canAttack: true
canAttackFlyingUnits: if self.queueSize<=0 and self.tags(includes="complete")
canAttackLandUnits: if self.queueSize<=0 and self.tags(includes="complete")
canAttackUnderwaterUnits: false
turretTurnSpeed: 6
maxAttackRange: 265
shootDelay: 0.924s
showRangeUIGuide:true

[turret_1]
canAttackCondition: if numberOfUnitsInNeutralTeam(withTag='disruptionWeb',withinRange=120)<=0 and self.hasUnitInTeam(withTag='pylon',withinRange=300)
x: 0
y: 0
barrelHeight: 22
shoot_sound:attack.ogg
shoot_sound_vol:0.3
recoilOffset: 0
shoot_flame:NONE
showRangeUIGuide:false
shouldResetTurret:false

[projectile_1]
directDamage: 150
areaDamage: 35
areaRadius: 39
life: 160
speed: 5
targetSpeed: 8
image: photon.png
explodeEffect:CUSTOM:sparks
explodeEffectOnShield:CUSTOM:sparks
mutator1_ifUnitWithTags: zergSwarm
mutator1_directDamageMultiplier:0

[movement]
movementType: NONE

[ai]
buildPriority: 0.09
noneInBaseExtraPriority: 0.09
noneGlobalExtraPriority: 0.09
maxEachBase: 2
recommendedInEachBaseNum: 1
upgradedFrom: buildPhotonCannon

[animation_notAttack]
body_0s: {frame:3}
body_0.08s: {frame:2}
body_0.16s: {frame:1}
body_0.24s: {frame:0}
body_0.32s: {frame:0}

[animation_attack]
body_0s: {frame:0}
body_0.08s: {frame:1}
body_0.16s: {frame:2}
body_0.24s: {frame:3}
body_0.32s: {frame:3}

[decal_grn_circle]
@copyFromSection: template_customSelectCircle
onlyWhenSelectedByOwnPlayer:true
image:ROOT:/DATA/total/circle_lrg_grn.png
yOffsetAbsolute:10

[decal_red_circle]
@copyFromSection: template_customSelectCircle
onlyWhenSelectedByEnemyPlayer:true
image:ROOT:/DATA/total/circle_lrg_red.png
yOffsetAbsolute:10

[decal_yellow_circle]
@copyFromSection: template_customSelectCircle
onlyWhenSelectedByAllyNotOwnPlayer:true
image:ROOT:/DATA/total/circle_lrg_yell.png
yOffsetAbsolute:10

[decal_hp]
@copyFromSection: template_customBar
@define totalFrames:16
image:ROOT:/DATA/total/hp_p17.png
frame_width:52
frame_height:7
frame:int((self.hp*100/self.maxHp)/(100/${totalFrames}))
yOffsetAbsolute:37

[decal_shield]
@copyFromSection: template_customBar
@define totalFrames:16
image:ROOT:/DATA/total/shield_p17.png
frame_width:52
frame_height:7
frame:int((self.shield*100/self.maxShield)/(100/${totalFrames}))
yOffsetAbsolute:37