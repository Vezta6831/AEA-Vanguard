[core]
copyFrom:ROOT:/DATA/total/forcesAttack.template, ROOT:/DATA/Terran/terranUpgrades.template, ROOT:/DATA/total/debuffs.template, ROOT:/DATA/total/customUI.template
name: battlecruiser
tags: mech,L,unit,haveEnergy
class: CustomUnitMetadata
price:Gas=4500
maxHp: 7800
armour:6
energyMax:200
energyRegen:0.01
energyStartingPercentage:0.25
mass: 5000000
displayText_ru: Крейсер
displayText: Behemoth Class Battlecruiser
displayDescription: -Heavy Air Goliath\n-Powerful AA and Land laser\n-Yamato Cannon Ability\n-Can Attack Subs\n-Battlecruiser operational
techLevel: 1
buildSpeed:90s
#availableInDemo: true
radius: 44
displayRadius: 46
isBio: true
hideScorchMark: false
isBug: false
isUnrepairableUnit: false
softCollisionOnAll: 1
explodeOnDeath: true
fogOfWarSightRange:31
explodeOnDeathGroundCollosion: true
effectOnDeath:CUSTOM:corpse
soundOnMoveOrder:battlecruiser_order.ogg:0.3,battlecruiser_order2.ogg:0.3,battlecruiser_order3.ogg:0.3,battlecruiser_order4.ogg:0.3
soundOnAttackOrder:battlecruiser_order.ogg:0.3,battlecruiser_order2.ogg:0.3,battlecruiser_order3.ogg:0.3,battlecruiser_order4.ogg:0.3
soundOnNewSelection:battlecruiser_order.ogg:0.3,battlecruiser_order2.ogg:0.3,battlecruiser_order3.ogg:0.3,battlecruiser_order4.ogg:0.3

[effect_sparks]
alwayStartDirAtZero:true
attachedToUnit: false
life: 100
alpha: 10
image:explode.png
priority: critical
drawUnderUnits:false
total_frames:10
animateFrameStart:0
animateFrameEnd:9
animateFrameSpeed:0.2
frame_width:  40
frame_height: 40

[effect_yamatoSparks]
alwayStartDirAtZero:true
attachedToUnit: false
life: 140
alpha: 14
image:yamatoSparks.png
priority: critical
drawUnderUnits:false
animateFrameStart:0
animateFrameEnd:13
animateFrameSpeed:0.2
frame_width:  144
frame_height: 144

[effect_shoot]
yOffsetRelative: 35
life: 50
alpha: 5
hSpeed: 0
image:shoot.png
priority: critical
drawUnderUnits:false
total_frames:5
animateFrameStart:0
animateFrameEnd:4
animateFrameSpeed:0.2
frame_width:  60
frame_height: 60

[effect_corpse]
alwayStartDirAtZero:true
attachedToUnit: false
life: 90
alpha: 9
image:ROOT:/DATA/Terran/units/death.png
priority: critical
drawUnderUnits:false
animateFrameStart:0
animateFrameEnd:8
animateFrameSpeed:0.2
alsoPlaySound:death.wav
frame_width:  128
frame_height: 128

[hiddenAction_soundOnCreate]
autoTriggerOnEvent: created
playSoundToPlayer:spawn.wav
requireConditional:if self.customTarget1!=nullUnit
addWaypoint_type:move
addWaypoint_target_fromReference: customTarget1.readUnitMemory(name="rally",type="unit")

[action_yamato]
alwaysSinglePress:true
price:energy=150
isVisible: if self.globalTeamTags(includes='PhysicalLabButtlecruiser') and self.ammo==0
isActive: if self.resource.lockdown<=0 and self.ammo==0 and self.resource.stasis<=0
buildSpeed:0s
text_ru:Пушка Ямато
text:Yamato gun
onlyOneUnitAtATime: true
ai_isDisabled: false
ai_isHighPriority:true
iconImage:ROOT:/DATA/Terran/yamato.png
addResources:ammo=1
resetCustomTimer: true
isLocked: if self.isControlledByAI() and ((not self.isAttacking() and distanceBetween(self, self.activeWaypointTarget)>320) or not self.isAttacking())

[hiddenAction_yamato_2]
alsoQueueAction:yamato_3

[hiddenAction_yamato_3]
buildSpeed:2s
whenBuilding_cannotMove:true
clearAllWaypoints: true

[hiddenAction_yamatoAddResource]
autoTrigger: if self.customTimer(laterThanSeconds=2) and self.ammo>0
addResources:energy=150,ammo=-1

[hiddenAction_armor]
autoTrigger: if self.resource(type='TerranAirArmor',greaterThan=0) and not self.tags(includes='armor1')
temporarilyAddTags: armor1
setUnitStats: armour+=1

[hiddenAction_armor_2]
autoTrigger: if self.resource(type='TerranAirArmor',greaterThan=1) and not self.tags(includes='armor2')
temporarilyAddTags: armor2
setUnitStats: armour+=1

[hiddenAction_armor_3]
autoTrigger: if self.resource(type='TerranAirArmor',greaterThan=2) and not self.tags(includes='armor3')
temporarilyAddTags: armor3
setUnitStats: armour+=1

[hiddenAction_maxEnergy]
autoTrigger: if self.globalTeamTags(includes='ColossusReactor') and not self.tags(includes='maxEnergy')
temporarilyAddTags: maxEnergy
setUnitStats: maxEnergy=250

[graphics]
image_offsetY:-14
total_frames: 3
icon_build: battlecruiser_icon.png
image:        battlecruiser.png
image_wreak:  NONE
image_turret: NONE
image_shadow: AUTO_ANIMATED
animation_moving_start: 1
animation_moving_end: 2
animation_moving_speed: 2.5
lock_body_rotation_with_main_turret: true
rotate_with_direction: false
animation_direction_units: 45
animation_direction_strideX:3
animation_direction_strideY:0
animation_direction_starting:180
frame_width:  120
frame_height: 120
imageScale:1.0

[attack]
canAttack: true
#canAttackFlyingUnits: if self.resource.lockdown<=0 and self.resource.maelstrom<=0 and self.resource.stasis<=0
#canAttackLandUnits:  if self.resource.lockdown<=0 and self.resource.maelstrom<=0 and self.resource.stasis<=0
canAttackFlyingUnits: true
canAttackLandUnits: true
canAttackUnderwaterUnits: true
isFixedFiring: true
turretSize: 6
turretTurnSpeed: 3
shootDelay: 1.79s
showRangeUIGuide:true

[turret_T1T2]
showRangeUIGuide:false
canAttackCondition: if (self.resource(type='TerranAirAttack',equalTo=0) or self.resource(type='TerranAirAttack',equalTo=1)) and self.ammo==0 and self.queueSize==0
x: 0
y: 0
projectile:T1
shoot_flame:CUSTOM:shoot
shoot_sound:attack.ogg
shoot_sound_vol:0.3
recoilOffset: 0
#barrelHeight: 10
limitingRange:320
altProjectile: T2
altProjectileCondition: if self.resource(type='TerranAirAttack',equalTo=1)

[turret_T3T4]
canAttackCondition: if (self.resource(type='TerranAirAttack',equalTo=2) or self.resource(type='TerranAirAttack',equalTo=3)) and self.ammo==0 and self.queueSize==0
@copyFromSection:turret_T1T2
projectile:T3
altProjectile: T4
altProjectileCondition: if self.resource(type='TerranAirAttack',equalTo=3)

[projectile_T1]
explodeEffect:CUSTOM:sparks
explodeEffectOnShield:CUSTOM:sparks
image:fire.png
directDamage: 160
areaDamage: 365
areaRadius: 90
life: 160
speed:12
mutator1_ifUnitWithTags: zergSwarm
mutator1_directDamageMultiplier:0

[projectile_T2]
directDamage: 170
areaDamage: 370
@copyFromSection:projectile_T1

[projectile_T3]
directDamage: 180
areaDamage: 375
@copyFromSection:projectile_T1

[projectile_T4]
directDamage: 190
areaDamage: 380
@copyFromSection:projectile_T1

[turret_yamato]
canAttackCondition: if self.ammo!=0
x: 0
y: 0
warmup:0.5s
shoot_flame:CUSTOM:shoot
shoot_sound:yamato.wav
shoot_sound_vol:0.3
recoilOffset: 0
resourceUsage:ammo=1
showRangeUIGuide:false
#barrelHeight: 10
projectile:nullYamato
limitingRange:320
onShoot_triggerActions: yamato_2

[projectile_nullYamato]
invisible: true
directDamage:0
life:80
speed:0
explodeEffect:NONE
explodeEffectOnShield:NONE
spawnProjectilesOnEndOfLife:yamato

[projectile_yamato]
image:fire2.png
directDamage: 3600
life: 160
speed:12
explodeEffect:CUSTOM:yamatoSparks
explodeEffectOnShield:CUSTOM:yamatoSparks

[movement]
movementType: AIR
moveSpeed: 0.68
moveAccelerationSpeed: 0.03
moveDecelerationSpeed: 0.02
maxTurnSpeed: 40
turnAcceleration: 40
reverseSpeedPercentage:0
joinsGroupFormations: false
startingHeightOffset: 35

[ai]
buildPriority: 0.8
noneInBaseExtraPriority: 0.8
noneGlobalExtraPriority: 0.8
maxEachBase: 10

[decal_ensnare_goo]
image:ROOT:/DATA/total/ensnare_goo_3.png

[decal_plague_goo]
image:ROOT:/DATA/total/plague_goo_3.png

[decal_defensive_matrix]
image:ROOT:/DATA/total/defensive_matrix_3.png

[decal_lockdown]
image:ROOT:/DATA/total/lockdown_3.png

[effect_mindControl]
image:ROOT:/DATA/total/mindControl_3.png
frame_width: 128
frame_height: 128

[effect_feedback]
image:ROOT:/DATA/total/feedback_2.png
frame_width: 128
frame_height: 128

[hiddenAction_debuff_maelstrom]
@copyFrom_skipThisSection: true

[hiddenAction_debuff_maelstrom_effect]
@copyFrom_skipThisSection: true

[hiddenAction_removeDebuff_maelstrom]
@copyFrom_skipThisSection: true

[decal_stasis]
image:ROOT:/DATA/total/stasis_2.png
frame_width: 128
frame_height: 128

[effect_restoration]
image:ROOT:/DATA/total/restoration_2.png
frame_width: 128
frame_height: 128

[decal_grn_circle]
@copyFromSection: template_customSelectCircle
onlyWhenSelectedByOwnPlayer:true
image:ROOT:/DATA/total/circle_lrg_grn_2.png

[decal_red_circle]
@copyFromSection: template_customSelectCircle
onlyWhenSelectedByEnemyPlayer:true
image:ROOT:/DATA/total/circle_lrg_red_2.png

[decal_yellow_circle]
@copyFromSection: template_customSelectCircle
onlyWhenSelectedByAllyNotOwnPlayer:true
image:ROOT:/DATA/total/circle_lrg_yell_2.png

[decal_hp]
@copyFromSection: template_customBar
@define totalFrames:23
image:ROOT:/DATA/total/hp_24.png
frame_width:73
frame_height:5
frame:int((self.hp*100/self.maxHp)/(100/${totalFrames}))
yOffsetAbsolute:35

[decal_energy]
@copyFromSection: template_customBar
@define totalFrames:24
onlyWhenSelectedByOwnPlayer:true
onlyWhenSelectedByAnyPlayer:false
image:ROOT:/DATA/total/energy_24.png
frame_width:73
frame_height:5
frame:int((self.energy*100/self.maxEnergy)/(100/${totalFrames}))
yOffsetAbsolute:41