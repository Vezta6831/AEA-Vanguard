[core]
copyFrom:ROOT:/DATA/Zerg/units/airUnits.template, ROOT:/DATA/Zerg/zergUpgrades.template, ROOT:/DATA/total/debuffs.template, ROOT:/DATA/total/customUI.template
name: queen
tags:M,bio,queen,haveEnergy,canConsume,unit
price:Minerals=300,Gas=150
maxHp: 750
energyMax: 200
energyRegen:0.01
energyStartingPercentage:0.25
displayText_ru: Королева
displayText: Queen
displayDescription: -Support Specialist\n-No basic attack\n-Can instantly kill a unit and spawn 2 broodlings\n-Can ensare targets in an AOE\n-Can inflict a parasite on a target, granting you it's vision\n-Can infest a Terran Command Center. Queen must be near a badly Damaged Command center(<50% HP) for this to happen
buildSpeed:24s
radius: 24
displayRadius: 26
soundOnMoveOrder: queen_order.ogg:0.3,queen_order2.ogg:0.3,queen_order3.ogg:0.3,queen_order4.ogg:0.3
soundOnAttackOrder: queen_order.ogg:0.3,queen_order2.ogg:0.3,queen_order3.ogg:0.3,queen_order4.ogg:0.3
soundOnNewSelection:queen_order.ogg:0.3,queen_order2.ogg:0.3,queen_order3.ogg:0.3,queen_order4.ogg:0.3

[hiddenAction_soundOnCreate]
autoTriggerOnEvent: created
requireConditional:if self.customTarget1!=nullUnit
playSoundToPlayer:spawn.ogg
addWaypoint_type:move
addWaypoint_target_fromReference: customTarget1.readUnitMemory(name="rally",type="unit")

[hiddenAction_maxEnergy]
autoTrigger: if self.globalTeamTags(includes='GameteMeiosis') and not self.tags(includes='maxEnergy')
temporarilyAddTags: maxEnergy
setUnitStats: maxEnergy=250, energy=62

[effect_ensnare]
alwayStartDirAtZero:true
attachedToUnit: false
life: 140
alpha: 14
image:ROOT:/DATA/Zerg/ensnare.png
priority: critical
drawUnderUnits:false
total_frames:15
animateFrameStart:0
animateFrameEnd:14
animateFrameSpeed:0.2
frame_width:  130
frame_height: 123
alsoPlaySound:ensnare.ogg:0.4

[action_parasit]
isActive: if self.resource.maelstrom<=0 and self.resource.stasis<=0
alwaysSinglePress:true
price:energy=75
buildSpeed:0s
text_ru:Паразит
text:Parasit
onlyOneUnitAtATime: true
fireTurretXAtGround:null
fireTurretXAtGround_withProjectile:null
ai_isDisabled: true
iconImage:parasite.png
addResources:energy=75
alsoTriggerAction:parasit_2
alsoTriggerOrQueueActionConditional: if (thisActionTarget.nearestUnit(withinRange=50, withTag='S', relation='any') == thisActionTarget.nearestUnit(withinRange=50,relation='any') or thisActionTarget.nearestUnit(withinRange=50, withTag='L', relation='any') == thisActionTarget.nearestUnit(withinRange=50,relation='any') or thisActionTarget.nearestUnit(withinRange=50, withTag='M', relation='any') == thisActionTarget.nearestUnit(withinRange=50,relation='any')) and thisActionTarget.nearestUnit(withinRange=50,relation='any') != nullUnit

[hiddenAction_parasit_2]
requireConditional: if thisActionTarget.nearestUnit(withinRange=50).teamId!=self.teamId
addResources:energy=-75
playAnimation:attack
stopLastAnimation:true
fireTurretXAtGround_withTarget: thisActionTarget
fireTurretXAtGround:parasit
fireTurretXAtGround_withProjectile:parasit
#playSoundAtUnit:parasite.ogg:0.4

[action_ensnare]
isVisible: if self.globalTeamTags(includes='Ensnare')
isActive: if self.resource.maelstrom<=0 and self.resource.stasis<=0
price:energy=75
buildSpeed:0s
text_ru:Паутина
text:Ensnare
fireTurretXAtGround:ensnare
fireTurretXAtGround_withProjectile:ensnare
onlyOneUnitAtATime: true
playAnimation:attack
stopLastAnimation:true
ai_isDisabled: true
iconImage:ROOT:/DATA/Zerg/ensnare_icon.png

[action_ensnare_ai]
price:energy=75
isVisible: if self.globalTeamTags(includes='Ensnare') and self.isControlledByAI()
isActive: if self.globalTeamTags(includes='Ensnare') and nearestUnit(withinRange=310, withTag='unit', relation='enemy') != nullUnit and self.resource.maelstrom<=0 and self.resource.stasis<=0
buildSpeed:0s
text_ru:Паутина
text:Ensnare
onlyOneUnitAtATime: true
fireTurretXAtGround:ensnare
fireTurretXAtGround_withProjectile:ensnare
fireTurretXAtGround_withTarget: nearestUnit(withinRange=320, withTag='unit', relation='enemy')
playAnimation:attack
stopLastAnimation:true
ai_isHighPriority: true
iconImage:ROOT:/DATA/Zerg/ensnare_icon.png

[action_broodling]
alwaysSinglePress:true
price:energy=150
isVisible: if self.globalTeamTags(includes='SpawnBroodlings') and self.resource(type='broodling',lessThan=1)
isActive: if self.globalTeamTags(includes='SpawnBroodlings') and self.resource(type='broodling',lessThan=1) and self.resource.maelstrom<=0 and self.resource.stasis<=0
buildSpeed:0s
text_ru:Породить брудлингов
text:Spawn Broodlings
whenBuilding_cannotMove:true
highPriorityQueue: true
ai_isDisabled: false
iconImage:ROOT:/DATA/Zerg/broodling_icon.png
ai_isHighPriority:true
resetCustomTimer:true
addResources:broodling=1
onlyOneUnitAtATime: true

[hiddenAction_broodlingAddResource]
autoTrigger: if self.customTimer(laterThanSeconds=2) and self.resource(type='broodling',greaterThan=0)
addResources:energy=150,broodling=-1

[action_infest]
isActive: if self.resource.maelstrom<=0 and self.resource.stasis<=0
text_ru: Заражение
text: Infest
buildSpeed: 0s
highPriorityQueue: false
fireTurretXAtGround: infest
fireTurretXAtGround_withProjectile:null
onlyOneUnitAtATime: true
ai_isDisabled:true
iconImage:infest.png
alsoTriggerAction:infest_2
alsoTriggerOrQueueActionConditional: if thisActionTarget.nearestUnit(withinRange=50, withTag='CommandCenter', relation='any') != nullUnit and thisActionTarget.nearestUnit(withinRange=50, withTag='CommandCenter', relation='any').hp<thisActionTarget.nearestUnit(withinRange=50, withTag='CommandCenter', relation='any').maxHp*0.5

[hiddenAction_infest_2]
addWaypoint_type: touchTarget
clearAllWaypoints:true
addWaypoint_target_fromReference: thisActionTarget.nearestUnit(withinRange=50, withTag='CommandCenter', relation='any') 

[hiddenAction_infest_3]
autoTriggerOnEvent: touchTargetSuccess
requireConditional: if eventSource.hp<eventSource.maxHp*0.5
sendMessageTo: eventSource
sendMessageWithTags:infest


[canBuild_1]
name: zdrone
pos:5

[canBuild_2]
isVisible: if self.queueSize(withActionTag="hatcheryOrder")<=0 and self.queueSize(withActionTag="pusto")<=0
name: zergling
isLocked: if not self.hasUnitInTeam(withTag='SpawningPool')
isLockedMessage_ru:Требуется:\n  >Омут рождения
isLockedMessage:Requires:\n  >Spawning pool

[canBuild_3]
isVisible: if self.queueSize(withActionTag="hatcheryOrder")<=0 and self.queueSize(withActionTag="pusto")<=0
name: hydralisk
isLocked: if not self.hasUnitInTeam(withTag='HydraliskDen')
isLockedMessage_ru:Требуется:\n  >Пещера Гидралисков
isLockedMessage:Requires:\n  >Hydralisk den


[canBuild_4]
isVisible: if self.queueSize(withActionTag="hatcheryOrder")<=0 and self.queueSize(withActionTag="pusto")<=0
name: scourge
isLocked: if not self.hasUnitInTeam(withTag='Spire')
isLockedMessage_ru:Требуется:\n  >Шпиль
isLockedMessage:Requires:\n  >Spire


[effect_corpse]
alwayStartDirAtZero:true
attachedToUnit: false
life: 50
alpha: 7
hSpeed: 0
image: death.png
priority: critical
drawUnderUnits:false
total_frames:7
animateFrameStart:0
animateFrameEnd:6
animateFrameSpeed:0.2
alsoPlaySound:death.wav
scaleFrom:1
scaleTo: 1

[graphics]
image_offsetY:-4
#image_offsetX:5
total_frames: 11
icon_build: queen_icon.png
image:        queen.png
image_wreak:  NONE
image_turret: NONE
image_shadow: AUTO_ANIMATED
animation_moving_start: 0
animation_moving_end: 4
animation_moving_speed: 3
animation_idle_start: 0
animation_idle_end: 4
animation_idle_speed: 4
lock_body_rotation_with_main_turret: true
rotate_with_direction: false
animation_direction_units: 45
animation_direction_strideX:11
animation_direction_strideY:0
animation_direction_starting:180
frame_width:  100
frame_height: 100

[attack]
disablePassiveTargeting: true
canAttackFlyingUnits: false
maxAttackRange: 310
shootDelay:1s
stopTargetingAfterFiring: true

[turret_null]
x: 0
y: 0
limitingRange:320
recoilOffset: 0
shoot_flame:NONE
#barrelHeight: 10
showRangeUIGuide:false
canAttackCondition: if self.globalTeamTags(includes='GOVNO')
projectile:null

[projectile_null]
directDamage: 0
life: 0
speed: 0
invisible:true
explodeEffect:NONE

[turret_parasit]
x: 0
y: 0
limitingRange:320
shoot_sound:shoot.ogg
shoot_sound_vol:0.3
recoilOffset: 0
shoot_flame:NONE
#barrelHeight: 10
showRangeUIGuide:false
canAttackCondition: if self.globalTeamTags(includes='GOVNO')
onShoot_freezeBodyMovementFor:0.6s
projectile:parasit

[projectile_parasit]
directDamage: 0
spawnUnit: parasite
targetGround: true
life: 160
speed: 4
targetSpeed: 8
image:arrow.png
explodeEffect:NONE

[turret_ensnare]
x: 0
y: 0
limitingRange:320
shoot_sound:shoot.ogg
shoot_sound_vol:0.3
recoilOffset: 0
shoot_flame:NONE
#barrelHeight: 10
showRangeUIGuide:false
canAttackCondition: if self.globalTeamTags(includes='GOVNO')
onShoot_freezeBodyMovementFor:0.6s
projectile:ensnare

[projectile_ensnare]
directDamage: 0
areaDamage:0
areaRadius:80
areaDamageNoFalloff: true
areaHitAirAndLandAtSameTime: true
friendlyFire: true
targetGround: true
life: 160
speed: 4
targetSpeed: 8
image:arrow.png
explodeEffect:CUSTOM:ensnare
mutator1_ifUnitWithTags:S,M,L
mutator1_ifUnitWithoutTags:undergroundZerg
mutator1_areaDamageMultiplier: 0
mutator1_addResourcesAreaHit: ensnare=25

[turret_broodling]
canOnlyAttackUnitsWithoutTags:NotBroodling,building
x: 0
y: 0
shoot_sound:shoot.ogg
shoot_sound_vol:0.3
shoot_flame:NONE
resourceUsage:broodling=1
limitingRange:310
#barrelHeight: 10
showRangeUIGuide:false
projectile:broodling
canAttackCondition: if self.resource(type="broodling",greaterThan=0)
onShoot_freezeBodyMovementFor:0.6s
clearTurretTargetAfterFiring:true

[projectile_broodling]
directDamage: 600
spawnUnit: broodling*2
life: 160
speed: 4
targetSpeed: 8
image:arrow.png
explodeEffect:NONE
buildingDamageMultiplier: 0
autoTargetingOnDeadTarget: true

[turret_infest]
x: 0
y: 0
limitingRange:9999
showRangeUIGuide:false

[movement]
moveSpeed: 1.9852

[resource_broodling]
hidden:false

[resource_infest]
hidden:false

[animation_attack]
onActions: attack
body_0s: {frame:5}
body_0.05s: {frame:5}
body_0.1s: {frame:6}
body_0.15s: {frame:7}
body_0.2s: {frame:8}
body_0.25s: {frame:9}
body_0.3s: {frame:10}
body_0.35s: {frame:11}

[decal_ensnare_goo]
image:ROOT:/DATA/total/ensnare_goo_2.png

[decal_plague_goo]
image:ROOT:/DATA/total/plague_goo_2.png

[decal_defensive_matrix]
image:ROOT:/DATA/total/defensive_matrix_2.png

[effect_mindControl]
image:ROOT:/DATA/total/mindControl_2.png
frame_width: 64
frame_height: 64

[effect_feedback]
image:ROOT:/DATA/total/feedback_2.png
frame_width: 128
frame_height: 128

[decal_maelstrom]
image:ROOT:/DATA/total/maelstrom_2.png
frame_width:  64
frame_height: 64

[decal_grn_circle]
@copyFromSection: template_customSelectCircle
onlyWhenSelectedByOwnPlayer:true
image:ROOT:/DATA/total/circle_med_grn.png

[decal_red_circle]
@copyFromSection: template_customSelectCircle
onlyWhenSelectedByEnemyPlayer:true
image:ROOT:/DATA/total/circle_med_red.png

[decal_yellow_circle]
@copyFromSection: template_customSelectCircle
onlyWhenSelectedByAllyNotOwnPlayer:true
image:ROOT:/DATA/total/circle_med_yell.png

[decal_hp]
@copyFromSection: template_customBar
@define totalFrames:10
image:ROOT:/DATA/total/hp_11.png
frame_width:34
frame_height:5
frame:int((self.hp*100/self.maxHp)/(100/${totalFrames}))
yOffsetAbsolute:23

[decal_energy]
@copyFromSection: template_customBar
@define totalFrames:11
onlyWhenSelectedByOwnPlayer:true
onlyWhenSelectedByAnyPlayer:false
image:ROOT:/DATA/total/energy_11.png
frame_width:34
frame_height:5
frame:int((self.energy*100/self.maxEnergy)/(100/${totalFrames}))
yOffsetAbsolute:29