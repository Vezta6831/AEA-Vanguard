[core]
copyFrom:ROOT:/DATA/total/baseAttack.template, ROOT:/DATA/total/debuffs.template, ROOT:/DATA/total/customUI.template
name: MachineShopBuild
tags:building,MShop
class: CustomUnitMetadata
price:Gas=115
maxHp: 1550
mass: 9000
armour:1
energyMax:25
energyRegen:0
generation_resources:energy=-0.25,hp=8.15
generation_delay:10
hideScorchMark: true
fogOfWarSightRange:8
displayText_ru:Машинный цех
displayText:Machine shop
footprint: -1,-1,1,1
constructionFootprint:-1,-1,1,1
buildingToFootprintOffsetX:10
buildingToFootprintOffsetY:2
exit_x:0
exit_y:40
techLevel: 1
buildSpeed: 1
selfBuildRate:1
radius: 40
buildingSelectionOffset: -8
isBuilder: true
nanoRange: 0
isBuilding: true
isBio: true
numBitsOnDeath: 12
isUnrepairableUnit:false
effectOnDeath:CUSTOM:corpse

[placementRule_farFromFactory]
anyRuleInGroup: Annex
searchTags: Factory
searchDistance: 35
searchOffsetX:-90
searchOffsetY: -20
minCount: 1
cannotPlaceMessage_ru: Здесь нельзя строить!
cannotPlaceMessage: You can't build it here!
searchTeam: own

[placementRule_farFromFactoryai]
anyRuleInGroup: Annex
searchTags: AIFactory
searchDistance: 115
minCount: 1
cannotPlaceMessage_ru: Здесь нельзя строить!
cannotPlaceMessage: You can't build it here!
searchTeam: own



[effect_corpse]
alwayStartDirAtZero:true
attachedToUnit: false
life: 120
alpha: 12
image:ROOT:/DATA/Terran/death.png
alsoPlaySound:ROOT:/DATA/total/buildingExplode.wav
priority: critical
drawUnderUnits:false
animateFrameStart:0
animateFrameEnd:11
animateFrameSpeed:0.2
frame_width:  252
frame_height: 200

[action_clear]
isVisible:true
isActive:true
buildSpeed:1s
price:0
text_ru:Уничтожить
text:Delete
iconImage:ROOT:/DATA/total/delete.png
addResources:hp=-3000,Minerals=38,Gas=38
ai_isDisabled:true

[hiddenAction_onCreate]
autoTriggerOnEvent:completeAndActive
addResources:hp=-749

[hiddenAction_life_Time]
autoTrigger: if self.energy(lessThan=1)
convertTo: MachineShop
playSoundToPlayer:ROOT:/DATA/Terran/addon.wav:0.4

[graphics]
total_frames: 1
icon_build: machineShop_icon.png
image:        buildAnnex_1.png
image_back:   NONE
image_wreak:ROOT:/DATA/Terran/dead.png
image_turret: NONE
drawLayer:experimentals
showEnergyBar:false
animation_idle_start: 0
animation_idle_end: 0
animation_idle_speed: 36

[arm_3]
hidden: if self.energy(greaterThan=6)
x:0
y:0
image_end:buildMS.png
image_end_teamColors:true
drawOverBody:true
lockMovement: false
rotateSpeed: 0

[arm_2]
hidden: if self.energy(greaterThan=12)
image_end:buildAnnex_3.png
@copyFromSection: arm_3

[arm_1]
hidden: if self.energy(greaterThan=19)
image_end:buildAnnex_2.png
@copyFromSection: arm_3

[attack]
canAttack: false
canAttackFlyingUnits: false
canAttackLandUnits:   false
canAttackUnderwaterUnits: false
turretSize: 0
turretTurnSpeed: 6
maxAttackRange: 0
shootDelay: 80

[movement]
movementType: NONE
moveSpeed: 0
moveAccelerationSpeed: 0.01
moveDecelerationSpeed: 0.01

maxTurnSpeed: 0
turnAcceleration: 0.1

[ai]
buildPriority: 0.1
noneInBaseExtraPriority: 0.1
noneGlobalExtraPriority: 0.1
maxEachBase: 4
recommendedInEachBaseNum: 4
#disableUse: true

[hiddenAction_debuff_ensnare]
@copyFrom_skipThisSection: true

[hiddenAction_removeDebuff_ensnare]
@copyFrom_skipThisSection: true

[hiddenAction_debuff_lockdown]
@copyFrom_skipThisSection: true

[hiddenAction_removeDebuff_lockdown]
@copyFrom_skipThisSection: true

[hiddenAction_debuff_stasis]
@copyFrom_skipThisSection: true

[hiddenAction_removeDebuff_stasis]
@copyFrom_skipThisSection: true

[hiddenAction_debuff_maelstrom]
@copyFrom_skipThisSection: true

[hiddenAction_debuff_maelstrom_effect]
@copyFrom_skipThisSection: true

[hiddenAction_removeDebuff_maelstrom]
@copyFrom_skipThisSection: true

[decal_ensnare_goo]
@copyFrom_skipThisSection: true

[decal_plague_goo]
image:ROOT:/DATA/total/plague_goo_3.png

[decal_grn_circle]
@copyFromSection: template_customSelectCircle
onlyWhenSelectedByOwnPlayer:true
image:ROOT:/DATA/total/circle_lrg_grn_2.png
yOffsetAbsolute:5

[decal_red_circle]
@copyFromSection: template_customSelectCircle
onlyWhenSelectedByEnemyPlayer:true
image:ROOT:/DATA/total/circle_lrg_red_2.png
yOffsetAbsolute:5

[decal_yellow_circle]
@copyFromSection: template_customSelectCircle
onlyWhenSelectedByAllyNotOwnPlayer:true
image:ROOT:/DATA/total/circle_lrg_yell_2.png
yOffsetAbsolute:5

[decal_hp]
@copyFromSection: template_customBar
@define totalFrames:23
image:ROOT:/DATA/total/hp_24.png
frame_width:73
frame_height:5
frame:int((self.hp*100/self.maxHp)/(100/${totalFrames}))
yOffsetAbsolute:40

[decal_fullConstuction]
onlyPlayersWithUnitControl:true
onlyTeam:ally
layer: afterBody
total_frames:4
image: machineShop.png
teamColors:true
onlyInPreview: true