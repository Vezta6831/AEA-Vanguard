[core]
#availableInDemo:         true
#displayRadius:           9
buildSpeed:               30s
canNotBeDirectlyAttacked: true
class:                    CustomUnitMetadata
copyFrom:                 ROOT:effects.template
disableAllUnitCollisions: true
displayDescription:       - Small Activation Range (Small Ring) \n- Can be Disarmed by Enemy Engineers (Middle Ring) \n- Remote Detonation From Engineers (Large Ring) \n- Does 500 damage (AOE) \n- Cannot be attacked
displayText:              Landmine
fogOfWarSightRange:       5
isBio:                    false
isBuilding:               false
mass:                     3000
maxHp:                    10
name:                     landmine
price:                    800
radius:                   9
selfBuildRate:            30s
softCollisionOnAll:       0
tags:                     land_mines, lds, mineOn
techLevel:                1
transportSlotsNeeded:     9999


[hiddenAction_minesdeleteself]
autoTrigger:             if self.timeAlive(laterThanSeconds=17)
deleteSelf:              true
showQuickWarLogToPlayer: Landmine Malfunction - (missing components). Entity Lost. 


[hiddenAction_realmine]
autoTriggerOnEvent: completeAndActive
convertTo:          landmineBuilt


[placementRule_mines_own]
@define rng:                70
blocksPlacement:            true
cannotPlaceMessage:         Cannot place Landmine within ${rng} range
checkEachTile:              true
excludeIncompleteBuildings: true
excludeNonBuildings:        false
maxCount:                   0
minCount:                   0
searchDistance:             ${rng}
searchTags:                 land_mines
searchTeam:                 any


[hiddenAction_clearWaypoint]
autoTriggerOnEvent:  newWaypointGivenByPlayer
clearActiveWaypoint: true


[hiddenAction_BuildOFf]
addResources:        ${core.price}
autoTriggerOnEvent:  created
deleteSelf:          true
requireConditional:  if numberOfUnitsInTeam(greaterThan=0, withTag='lds', withinRange= 70, incompleteBuildings=true)
showMessageToPlayer: Cannot place here!


[action_autoOff]
buildSpeed:    2s
convertTo:     landmineOff
description:   - Turns off auto detonation when units get in range\n- Useful when using remote detonation\n- Takes 10 seconds
displayType:   action
isGuiBlinking: true
text:          Disable AutoDetonate


[action_RemoteDetonate]
autoTrigger:         if numberOfUnitsInTeam(greaterThan=0, withTag='Explode', withinRange=800)
description:         - Explodes land mines remotely \n- Will automatically explode when in close proximity
displayType:         action
fireTurretXAtGround: 1
isGuiBlinking:       true
isLocked:            false
isVisible:           false
pos:                 1
text:                Remote Detonate


[hiddenAction_diffusedLandmind]
addResources:       hp=-${core.maxHp}
autoTriggerOnEvent: newMessage(withTag="diffuseLandmine")
deleteSelf:         true
spawnEffects:       CUSTOM:diffLM


[effect_diffLM]
alpha:                2
attachedToUnit:       false
color:                #ffffff
createWhenOverLiquid: false
dirOffsetRandom:      180
drawUnderUnits:       true
fadeInTime:           1
fadeOut:              true
image:                ROOT:data\images\YouMad.png
life:                 500
priority:             critical
scaleFrom:            0.35
scaleTo:              0.35
xOffsetRelative:      0
yOffsetRelative:      0


[hiddenAction_ShowLandMines]
autoTrigger:  if numberOfUnitsInEnemyTeam(greaterThan=0, withTag='Engineer', withinRange=800)
description:  - Shows the location of landmines when engineer is within range
spawnEffects: CUSTOM:mineFlare
text:         hiddenAction_ShowLandMines


[turret_RemoteRangeUI]
limitingRange:    800
showRangeUIGuide: true
turnSpeed:        0
x:                0
y:                0


[turret_DisarmRangeUI]
limitingRange:    360
showRangeUIGuide: true
turnSpeed:        0
x:                0
y:                0


[graphics]
#animation_idle_pingPong: true
animation_idle_end:       3
animation_idle_speed:     6
animation_idle_start:     0
icon_zoomed_out:          mine_on.png
image_shadow:             AUTO
image_turret:             NONE
image_wreak:              NONE
image:                    simple_mine.png
isVisibleToEnemies:       false
shadowOffsetX:            1
shadowOffsetY:            1
total_frames:             4


[attack]
canAttack:                true
canAttackFlyingUnits:     false
canAttackLandUnits:       true
canAttackUnderwaterUnits: false
dieOnAttack:              true
isMelee:                  true
maxAttackRange:           70
shootDelay:               1
turretSize:               20
turretTurnSpeed:          15


[turret_1]
canAttackFlyingUnits:     false
canAttackLandUnits:       true
canAttackUnderwaterUnits: false
canShoot:                 true
idleDir:                  0
invisible:                true
limitingRange:            70
projectile:               1
showRangeUIGuide:         true
size:                     1.1
turnSpeed:                15
x:                        0
y:                        0


[projectile_1]
#targetGround:  true
areaDamage:     600
areaRadius:     200
directDamage:   0
frame:          15
instant:        true
largeHitEffect: true
life:           1


[movement]
maxTurnSpeed:          0
moveAccelerationSpeed: 0
moveDecelerationSpeed: 0
moveIgnoringBody:      false
movementType:          LAND
moveSlidingMode:       false
moveSpeed:             0
targetHeight:          -3
targetHeightDrift:     0
turnAcceleration:      0

