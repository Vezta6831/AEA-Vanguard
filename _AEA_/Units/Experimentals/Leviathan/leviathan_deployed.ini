[core]
@global                      legX: 50
builtFrom_1_name:            NONE
class:                       CustomUnitMetadata
copyFrom:                    leviathan.ini
displayDescription:          [Deployed]\n- An Absolute Unit.\n- Can attack Ground & Air\n- VERY Heavily armed and armored\n- Can run over smaller units\n- Deploy to activate Singularity Cannon\n- Cannot attack air while deployed
displayRadius:               65
displayText:                 Leviathan
energyMax:                   1
energyNeedsToRechargeToFull: true
energyRegen:                 0.003
fogOfWarSightRange:          35
isBio:                       false
isBuilding:                  true
mass:                        9999999
name:                        leviathan_deployed_n
nukeOnDeath:                 true
radius:                      65
showInEditor:                false
softCollisionOnAll:          0
tags:                        leviathan, exp, levDeployed, idontlikestuns
transportSlotsNeeded:        1000


[action_Singularity_Cannon]
#addActionCooldownTime: 1s
addActionCooldownTime:  ${SCcool}s
addResources:           beam=24, energy=1
allowMultipleInQueue:   false
alsoQueueAction:        Singularity_CannonA
buildSpeed:             0s
canPlayerCancel:        false
description:            - Fire Singularity Cannon to desire location\nand Boom\n- Warmup: 6s, Range ${SCrange}, cooldown: ${SCcool}s
fireTurretXAtGround:    range
highPriorityQueue:      true
iconImage:              Singularity_Cannon2.png
isGuiBlinking:          if self.isEnergyFull() and self.hasResources(uranium=500) and self.customTimer(laterThanSeconds=${SCcool})
isVisible:              if not self.hasFlag(id=12)
pos:                    0
price:                  energy=1, uranium=1000
resetCustomTimer:       true
text:                   Singularity Cannon


[action_Singularity_CannonPass]
buildSpeed:  0s
description: - Undeploying, Singularity Cannon disabled
displayType: infoOnlyNoBox
iconImage:   Singularity_Cannon2.png
isVisible:   if self.hasFlag(id=12)
pos:         0
text:        Singularity Cannon


[hiddenAction_Singularity_CannonA]
alsoQueueAction:                         Singularity_CannonB
buildSpeed:                              0s
fireTurretXAtGround:                     range
whenBuilding_rotateTo_aimAtActionTarget: true
whenBuilding_rotateTo_rotateTurretX:     SC
whenBuilding_rotateTo_waitTillRotated:   true


[hiddenAction_Singularity_CannonB]
addResources:                            beam=-1
alsoQueueAction:                         Singularity_CannonB, Singularity_CannonBoom
alsoTriggerAction:                       Singularity_CannonB_Be
buildSpeed:                              0.25s
fireTurretXAtGround:                     SC
requireConditional:                      if self.resource(type='beam', greaterThan=0)
whenBuilding_rotateTo_aimAtActionTarget: true
whenBuilding_rotateTo_rotateTurretX:     SC
whenBuilding_rotateTo_waitTillRotated:   true


[hiddenAction_Singularity_CannonB_Be]
addResources:        setFlag=7
fireTurretXAtGround: BluEr
requireConditional:  if not self.hasFlag(id=7)


[hiddenAction_Singularity_CannonBoom]
addResources:       energy=-1, setFlag=6
alsoQueueAction:    unF
buildSpeed:         0s
playSoundAtUnit:    ROOT:data\soundFx\railgun_vibration.ogg
requireConditional: if not self.resource(type='beam', greaterThan=0) and not self.hasFlag(id=6)


[hiddenAction_unF]
addResources: unsetFlag=6-7


[resource_beam]
displayName: Beam
hidden:      true


[action_returnA]
#playAnimation:  close
addResources:    setFlag=8, unsetFlag=15, setFlag=12
alsoQueueAction: startAnimation_returnA
buildSpeed:      0s
description:     - Undeploy time: 7.5s
iconImage:       undeploy.png
isVisible:       if not self.hasFlag(id=8)
pos:             0
text:            Undeploy


[action_testanimationpasB]
buildSpeed:  0s
displayType: infoOnlyNoBox
iconImage:   undeploy.png
isVisible:   if self.hasFlag(id=8)
pos:         0
text:        Undeploying


[hiddenAction_startAnimation_returnA]
addResources:                      setFlag=9
alsoQueueAction:                   startAnimation_returnA_flag
buildSpeed:                        1s
playAnimation:                     close
whenBuilding_cannotMove:           true
whenBuilding_temporarilyConvertTo: leviathan_deployed_temp_n


[hiddenAction_startAnimation_returnA_flag]
addResources:                      setFlag=10, unsetFlag=15
alsoQueueAction:                   TransF_ConvertToUD
buildSpeed:                        1.5s
whenBuilding_cannotMove:           true
whenBuilding_temporarilyConvertTo: leviathan_deployed_temp_n


[hiddenAction_TransF_ConvertToUD]
addResources:                      unsetFlag=3-15
buildSpeed:                        5s
convertTo:                         leviathan_n
whenBuilding_cannotMove:           true
whenBuilding_temporarilyConvertTo: leviathan_deployed_temp_n


[action_testanimationpas]
isVisible: false


[action_horn]
#@copyFrom_skipThisSection: true


[hiddenAction_clearWaypoin]
alsoTriggerAction:  OnkyMove
autoTriggerOnEvent: newWaypointGivenByPlayer


[hiddenAction_OnkyMove]
clearActiveWaypoint: true
highPriorityQueue:   true
requireConditional:  if self.hasActiveWaypoint(type='MOVE') or self.hasActiveWaypoint(type='ATTACKMOVE') or self.hasActiveWaypoint(type='GUARD') or self.hasActiveWaypoint(type='FOLLOW')


# Main Arm
[arm_1]
hidden: if not self.hasFlag(id=9)


[arm_4]
y: -16
hidden: if not self.hasFlag(id=10)


[arm_5]
hidden: if not self.hasFlag(id=10)


[arm_6]
hidden: if not self.hasFlag(id=10)


[arm_7]
hidden: if not self.hasFlag(id=10)


# MG Cylinder
[arm_14]
hidden: if not self.hasFlag(id=9) and self.hasFlag(id=10) or self.hasFlag(id=9) and self.hasFlag(id=10) and not self.hasFlag(id=15) or self.hasFlag(id=15)
x:      -4.5
y:      -17.5


# MG Cylinder
[arm_15]
x: 4.5
y: -17.5


# MG Rail
[arm_16]
x: -1
y: -7


# MG Rail
[arm_17]
x: 1
y: -7


# MG Recoil
[arm_18]
x: 0
y: -16


# MG Top
[arm_19]
x: -4.5
y: -7


[arm_20]
x: 4.5
y: -7


[leg_1]
hidden: if self.hasFlag(id=5)


[graphics]
total_frames: 6


[attack]
canAttackFlyingUnits: false


# Dummy
[turret_MainBody]
invisible: if self.hasFlag(id=9)
x:         0
y:         0


[turret_smolBaerbette]
x: 0
y: 0


# Top Left Cannon
[turret_cannon1]
invisible: if self.hasFlag(id=9)
x:         0
y:         0


# Top Right Cannon
[turret_cannon2]
x: 0
y: 0


# Bottom Left Cannon
[turret_cannon3]
x: 0
y: 0


# Bottom Right Cannon
[turret_cannon4]
x: 0
y: 0


# Top Left Base
[turret_base1]
invisible:             if self.hasFlag(id=9)
turnSpeed:             4
turnSpeedAcceleration: 0.5


# Top Right Base
[turret_base2]
@copyFromSection: turret_base1


# Bottom Left Base
[turret_base3]
@copyFromSection: turret_base1


# Bottom Right Base
[turret_base4]
@copyFromSection: turret_base1


[turret_Mbase]
canShoot:  false
invisible: true
x:         0
y:         0


[turret_aabarrel]
canShoot:  false
invisible: true


# Singularity Cannon
[turret_SC]
@copyFromSection:         turret_base1
#idleSpin:                0.5
altProjectile:            Sconan
altProjectileCondition:   if self.resource(type='beam', lessThan=1)
canAttackFlyingUnits:     false
canAttackLandUnits:       false
canAttackUnderwaterUnits: false
canShoot:                 false
delay:                    60
idleDir:                  0
idleDirReversing:         0
image:                    leviathan_mainG_sample2.png
invisible:                false
limitingRange:            ${SCrange}
projectile:               beam
recoilOffset:             0
recoilOutTime:            0
recoilReturnTime:         0
size:                     20
turnSpeed:                1
turnSpeedAcceleration:    0.3
x:                        0
y:                        -33


# == Singularity Cannon Heat Effect == #
# Dummy
[turret_SCheat_0]
attachedTo:      SC
canShoot:        false
image:           leviathan_mainG_heat.png
invisible:       if self.energy(greaterThan=0.05)
projectile:      Dummy
shoot_flame:     NONE
shoot_sound_vol: 0
shoot_sound:     NONE
size:            5
slave:           true
turnSpeed:       0
x:               0
y:               0


[turret_SCheat_1]
@copyFromSection: turret_SCheat_0
invisible:        if self.energy(greaterThan=0.1)


[turret_SCheat_2]
@copyFromSection: turret_SCheat_0
invisible:        if self.energy(greaterThan=0.2)


[turret_SCheat_3]
@copyFromSection: turret_SCheat_0
invisible:        if self.energy(greaterThan=0.3)


[turret_SCheat_4]
@copyFromSection: turret_SCheat_0
invisible:        if self.energy(greaterThan=0.4)


[turret_SCheat_5]
@copyFromSection: turret_SCheat_0
invisible:        if self.energy(greaterThan=0.5)


[turret_SCheat_6]
@copyFromSection: turret_SCheat_0
invisible:        if self.energy(greaterThan=0.6)


[turret_SCheat_7]
@copyFromSection: turret_SCheat_0
invisible:        if self.energy(greaterThan=0.7)


[turret_SCheat8]
@copyFromSection: turret_SCheat_0
invisible:        if self.energy(greaterThan=0.8)


[turret_SCheat_9]
@copyFromSection: turret_SCheat_0
invisible:        if self.energy(greaterThan=0.85)


[turret_SCheat_10]
@copyFromSection: turret_SCheat_0
invisible:        if self.energy(greaterThan=0.9)


[turret_SCheat_11]
@copyFromSection: turret_SCheat_0
invisible:        if self.energy(greaterThan=0.95)


[turret_effect]
canShoot:      true
invisible:     true
limitingRange: ${SCrange}
projectile:    dummy
slave:         false
x:             0
y:             0


[movement]
maxTurnSpeed: 0
movementType: NONE
moveSpeed:    0

